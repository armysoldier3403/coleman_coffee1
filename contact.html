<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contact The Daily Grind</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <header>
            <img src="logo.jpg" alt="The Daily Grind Logo" class="logo">
            <nav>
                <a href="index.html">Home</a>
                <a href="houseblend.html">House Blend</a>
                <a href="poll.html">Poll</a>
                <a href="#">Shop Online</a>
                <a href="contact.html">Contact Us</a>
                <a href="#">About Us</a>
                <a href="sitemap.html">Site Map</a>
                <a href="register.html">Register</a>
                <a href="login.html">Login</a>
            </nav>
        </header>

        <main>
            <h1>Contact The Daily Grind</h1>
            
            <div class="form-container">
                <form id="contactForm" action="process_contact.php" method="POST">
                    <div class="form-group">
                        <label for="salutation">Salutation:</label>
                        <select id="salutation" name="salutation">
                            <option value="">--Select--</option>
                            <option value="Mr.">Mr.</option>
                            <option value="Ms.">Ms.</option>
                            <option value="Mrs.">Mrs.</option>
                            <option value="Dr.">Dr.</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="first_name">First Name:</label>
                        <input type="text" id="first_name" name="first_name" required>
                        <span id="first_name_error" class="error-message"></span>
                    </div>

                    <div class="form-group">
                        <label for="last_name">Last Name:</label>
                        <input type="text" id="last_name" name="last_name" required>
                        <span id="last_name_error" class="error-message"></span>
                    </div>

                    <div class="form-group">
                        <label for="email_address">E-mail Address:</label>
                        <input type="email" id="email_address" name="email_address" required>
                        <span id="email_address_error" class="error-message"></span>
                    </div>

                    <div class="form-group">
                        <label for="phone_number">Phone Number:</label>
                        <input type="tel" id="phone_number" name="phone_number">
                    </div>

                    <div class="form-group">
                        <label for="subject">Subject:</label>
                        <input type="text" id="subject" name="subject">
                    </div>

                    <div class="form-group">
                        <label for="comments">Comments:</label>
                        <textarea id="comments" name="comments" rows="5"></textarea>
                    </div>

                    <div class="checkbox-group">
                        <input type="checkbox" id="receive_reply" name="receive_reply" value="yes">
                        <label for="receive_reply">Please check here if you wish to receive a reply:</label>
                    </div>

                    <div class="button-group">
                        <button type="submit" class="btn">Submit</button>
                        <button type="reset" class="btn btn-secondary">Reset Form</button>
                    </div>
                </form>
                <div id="form-message" class="message-box" style="display: none;"></div>
            </div>
        </main>

        <p class="mt-8">
            <a href="index.html" class="btn btn-secondary">Back to Main Page</a>
        </p>
    </div>

    <footer>
        <p id="current-datetime"></p> <!-- Placeholder for current date and time -->
        <p>&copy; 2023 The Daily Grind Coffee House. All rights reserved.</p>
    </footer>

    <script>
        // JavaScript to add the current date and time from server to the footer
        document.addEventListener('DOMContentLoaded', function() {
            const datetimeElement = document.getElementById('current-datetime');
            if (datetimeElement) {
                fetch('get_datetime.php')
                    .then(response => response.text())
                    .then(data => {
                        datetimeElement.textContent = data;
                    })
                    .catch(error => {
                        console.error('Error fetching date and time:', error);
                        datetimeElement.textContent = 'Date and time unavailable.';
                    });
            }

            // Contact Form Validation and AJAX Submission
            const contactForm = document.getElementById('contactForm');
            const firstNameInput = document.getElementById('first_name');
            const lastNameInput = document.getElementById('last_name');
            const emailInput = document.getElementById('email_address');
            const formMessage = document.getElementById('form-message');

            const firstNameError = document.getElementById('first_name_error');
            const lastNameError = document.getElementById('last_name_error');
            const emailError = document.getElementById('email_address_error');

            function showMessage(message, type) {
                formMessage.textContent = message;
                formMessage.className = `message-box ${type}`;
                formMessage.style.display = 'block';
            }

            function validateField(inputElement, errorElement, errorMessage) {
                if (inputElement.value.trim() === '') {
                    inputElement.classList.add('invalid');
                    errorElement.textContent = errorMessage;
                    return false;
                } else {
                    inputElement.classList.remove('invalid');
                    errorElement.textContent = '';
                    return true;
                }
            }

            function validateEmail(inputElement, errorElement, errorMessage) {
                const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!emailPattern.test(inputElement.value.trim())) {
                    inputElement.classList.add('invalid');
                    errorElement.textContent = errorMessage;
                    return false;
                } else {
                    inputElement.classList.remove('invalid');
                    errorElement.textContent = '';
                    return true;
                }
            }

            contactForm.addEventListener('submit', function(event) {
                event.preventDefault(); // Prevent default form submission

                let isValid = true;
                formMessage.style.display = 'none'; // Hide previous messages

                // Validate First Name
                if (!validateField(firstNameInput, firstNameError, 'First Name is required.')) {
                    isValid = false;
                }

                // Validate Last Name
                if (!validateField(lastNameInput, lastNameError, 'Last Name is required.')) {
                    isValid = false;
                }

                // Validate Email
                if (!validateEmail(emailInput, emailError, 'Please enter a valid email address.')) {
                    isValid = false;
                }

                if (isValid) {
                    // If client-side validation passes, submit via AJAX
                    const formData = new FormData(contactForm);
                    fetch('process_contact.php', {
                        method: 'POST',
                        body: formData
                    })
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            showMessage(data.message, 'success');
                            contactForm.reset(); // Clear form on successful submission
                        } else {
                            showMessage(data.message, 'error');
                        }
                    })
                    .catch(error => {
                        console.error('Error:', error);
                        showMessage('There was an error submitting your form. Please try again.', 'error');
                    });
                } else {
                    showMessage('Please correct the errors in the form.', 'error');
                }
            });

            contactForm.addEventListener('reset', function(event) {
                // Clear all input fields and error messages
                firstNameInput.value = '';
                lastNameInput.value = '';
                emailInput.value = '';
                document.getElementById('salutation').value = '';
                document.getElementById('phone_number').value = '';
                document.getElementById('subject').value = '';
                document.getElementById('comments').value = '';
                document.getElementById('receive_reply').checked = false;

                firstNameInput.classList.remove('invalid');
                lastNameInput.classList.remove('invalid');
                emailInput.classList.remove('invalid');

                firstNameError.textContent = '';
                lastNameError.textContent = '';
                emailError.textContent = '';

                formMessage.style.display = 'none'; // Hide any displayed messages
                formMessage.textContent = '';
            });
        });
    </script>
</body>
</html>
